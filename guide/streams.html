<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Streaming | Xlsx2Go</title>
    <meta name="description" content="Fast and Reliable way to work with xlsx in Golang">
    
    
    <link rel="preload" href="/xlsx/assets/css/0.styles.cf43dc97.css" as="style"><link rel="preload" href="/xlsx/assets/js/app.ec061189.js" as="script"><link rel="preload" href="/xlsx/assets/js/3.ac6e1e77.js" as="script"><link rel="preload" href="/xlsx/assets/js/21.f96bcf35.js" as="script"><link rel="prefetch" href="/xlsx/assets/js/10.f98f3d66.js"><link rel="prefetch" href="/xlsx/assets/js/11.12ccd6e3.js"><link rel="prefetch" href="/xlsx/assets/js/12.c3d18274.js"><link rel="prefetch" href="/xlsx/assets/js/13.8d04bffb.js"><link rel="prefetch" href="/xlsx/assets/js/14.54293b8f.js"><link rel="prefetch" href="/xlsx/assets/js/15.e3e1791e.js"><link rel="prefetch" href="/xlsx/assets/js/16.9e2fb8af.js"><link rel="prefetch" href="/xlsx/assets/js/17.7461aa81.js"><link rel="prefetch" href="/xlsx/assets/js/18.2e60ca10.js"><link rel="prefetch" href="/xlsx/assets/js/19.f6a078b7.js"><link rel="prefetch" href="/xlsx/assets/js/20.78f21eda.js"><link rel="prefetch" href="/xlsx/assets/js/22.798718c6.js"><link rel="prefetch" href="/xlsx/assets/js/23.5337806b.js"><link rel="prefetch" href="/xlsx/assets/js/24.27074952.js"><link rel="prefetch" href="/xlsx/assets/js/4.1c518a87.js"><link rel="prefetch" href="/xlsx/assets/js/5.323d2607.js"><link rel="prefetch" href="/xlsx/assets/js/6.fa332cba.js"><link rel="prefetch" href="/xlsx/assets/js/7.7fa38d45.js"><link rel="prefetch" href="/xlsx/assets/js/8.cdaa1b8e.js"><link rel="prefetch" href="/xlsx/assets/js/9.62881055.js"><link rel="prefetch" href="/xlsx/assets/js/vendors~docsearch.3888787f.js">
    <link rel="stylesheet" href="/xlsx/assets/css/0.styles.cf43dc97.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/xlsx/" class="home-link router-link-active"><img src="/xlsx/logo.png" alt="Xlsx2Go" class="logo"> <span class="site-name can-hide">Xlsx2Go</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/xlsx/" class="nav-link">Home</a></div><div class="nav-item"><a href="/xlsx/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://godoc.org/github.com/plandem/xlsx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/plandem/xlsx" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/xlsx/" class="nav-link">Home</a></div><div class="nav-item"><a href="/xlsx/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="https://godoc.org/github.com/plandem/xlsx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/plandem/xlsx" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Guide</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/xlsx/guide/" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xlsx/guide/#license" class="sidebar-link">License</a></li></ul></li><li><a href="/xlsx/guide/getting-started.html" class="sidebar-link">Getting Started</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/access.html" class="sidebar-link">Access</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/iterate.html" class="sidebar-link">Iterate</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/values.html" class="sidebar-link">Values</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/merged-cells.html" class="sidebar-link">Merged Cells</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/rich-text.html" class="sidebar-link">Rich Text</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/hyperlinks.html" class="sidebar-link">Hyperlinks</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/comments.html" class="sidebar-link">Comments</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/styles-formatting.html" class="sidebar-link">Styles Formatting</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/conditional-formatting.html" class="sidebar-link">Conditional Formatting</a></li><li><a href="/xlsx/guide/copy.html" class="sidebar-link">Copying</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/streams.html" class="active sidebar-link">Streaming</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/xlsx/guide/filters.html" class="sidebar-link">Filters</a></li><li><a href="/xlsx/guide/limits.html" class="sidebar-link">Limits</a></li></ul></section></li><li><a href="/xlsx/faq/" class="sidebar-link">F.A.Q.</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="streaming"><a href="#streaming" aria-hidden="true" class="header-anchor">#</a> Streaming</h1> <p></p><div class="table-of-contents"><ul><li><a href="#reading-sheet">Reading sheet</a></li><li><a href="#writing-sheet">Writing sheet</a></li></ul></div><p></p> <p>In some cases, when input file is really huge, more advanced techniques required to process data. Streaming is a most commonly used way to lazy load and process by blocks to:</p> <ul><li>reduce overall memory usage and</li> <li>reduce time of initial loading</li></ul> <p>Full stream support of xlsx files can be challenging task. More over, in real world only sheets holds huge data to process. Taking this into account, the real world task will be to stream sheets, but not xlsx file entirely.</p> <div class="warning custom-block"><p class="custom-block-title">Limits</p> <p>Xlsx2Go supports only limited set of features during sheet streaming.</p></div> <h3 id="reading-sheet"><a href="#reading-sheet" aria-hidden="true" class="header-anchor">#</a> Reading sheet</h3> <p>To stream in sheet, you should open it in <code>Stream</code> mode. After that you can access cells in sheet in a normal way.</p> <div class="note custom-block"><p class="custom-block-title">N.B.</p> <p>Sheets that were opened as stream, should be closed to free allocated resources.</p></div> <div class="language-go extra-class"><pre class="language-go"><code>	sheet <span class="token operator">:=</span> xl<span class="token punctuation">.</span><span class="token function">Sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeStream<span class="token punctuation">)</span>
	
	<span class="token comment">//close sheet to free allocated resources</span>
	<span class="token keyword">defer</span> sheet<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">Stream Mode</p> <p>If sheet previously was opened in normal mode, then you can't open it in stream mode. The reason is simple - streaming is for optimization, if information was totally loaded, then nothing to optimize.</p></div> <div class="tip custom-block"><p class="custom-block-title">Merged cells, Hyperlinks and etc</p> <p>By default, there is no access to merged cells, hyperlinks and conditional formatting information, to get access you should open sheet in <code>Multi Phase</code> mode. In that case sheet will be processed few times - first one to load <code>later</code> information, such as merged cells, and last phase for actual streaming cells info.</p></div> <div class="language-go extra-class"><pre class="language-go"><code>	sheet <span class="token operator">:=</span> xl<span class="token punctuation">.</span><span class="token function">Sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeStream<span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeMultiPhase<span class="token punctuation">)</span>
	<span class="token keyword">defer</span> sheet<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example</h4> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> code

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;github.com/plandem/xlsx&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">Example_readStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	xl<span class="token punctuation">,</span> err <span class="token operator">:=</span> xlsx<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;./foo.xlsx&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">defer</span> xl<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	sheet <span class="token operator">:=</span> xl<span class="token punctuation">.</span><span class="token function">Sheet</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeStream<span class="token punctuation">)</span>
	<span class="token keyword">defer</span> sheet<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	totalCols<span class="token punctuation">,</span> totalRows <span class="token operator">:=</span> sheet<span class="token punctuation">.</span><span class="token function">Dimension</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> rIdx <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> rIdx <span class="token operator">&lt;</span> totalRows<span class="token punctuation">;</span> rIdx<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> cIdx <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> cIdx <span class="token operator">&lt;</span> totalCols<span class="token punctuation">;</span> cIdx<span class="token operator">++</span> <span class="token punctuation">{</span>
			cell <span class="token operator">:=</span> sheet<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span>cIdx<span class="token punctuation">,</span> rIdx<span class="token punctuation">)</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="writing-sheet"><a href="#writing-sheet" aria-hidden="true" class="header-anchor">#</a> Writing sheet</h3> <p>To stream out sheet, you should create it with <code>Stream</code> mode. After that you can access cells in sheet in a normal way.</p> <div class="language-go extra-class"><pre class="language-go"><code>	sheet <span class="token operator">:=</span> xl<span class="token punctuation">.</span><span class="token function">AddSheet</span><span class="token punctuation">(</span><span class="token string">&quot;new sheet&quot;</span><span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeStream<span class="token punctuation">)</span>	
</code></pre></div><div class="note custom-block"><p class="custom-block-title">N.B.</p> <p>Sheets that were created as stream, will auto close self during save phase, so no need to close it manually.</p></div> <h4 id="example-2"><a href="#example-2" aria-hidden="true" class="header-anchor">#</a> Example</h4> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> code

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/plandem/xlsx&quot;</span>
	<span class="token string">&quot;github.com/plandem/xlsx/types&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">Example_writeStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	xl <span class="token operator">:=</span> xlsx<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	sheet <span class="token operator">:=</span> xl<span class="token punctuation">.</span><span class="token function">AddSheet</span><span class="token punctuation">(</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">,</span> xlsx<span class="token punctuation">.</span>SheetModeStream<span class="token punctuation">)</span>

	<span class="token keyword">for</span> iRow<span class="token punctuation">,</span> iRowMax <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">;</span> iRow <span class="token operator">&lt;</span> iRowMax<span class="token punctuation">;</span> iRow<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> iCol<span class="token punctuation">,</span> iColMax <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">;</span> iCol <span class="token operator">&lt;</span> iColMax<span class="token punctuation">;</span> iCol<span class="token operator">++</span> <span class="token punctuation">{</span>
			sheet<span class="token punctuation">.</span><span class="token function">Cell</span><span class="token punctuation">(</span>iCol<span class="token punctuation">,</span> iRow<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetValue</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token function">CellRefFromIndexes</span><span class="token punctuation">(</span>iCol<span class="token punctuation">,</span> iRow<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	xl<span class="token punctuation">.</span><span class="token function">SaveAs</span><span class="token punctuation">(</span><span class="token string">&quot;./foo.xlsx&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/17/2019, 8:44:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/xlsx/guide/copy.html" class="prev">
          Copying
        </a></span> <span class="next"><a href="/xlsx/guide/filters.html">
          Filters
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/xlsx/assets/js/app.ec061189.js" defer></script><script src="/xlsx/assets/js/3.ac6e1e77.js" defer></script><script src="/xlsx/assets/js/21.f96bcf35.js" defer></script>
  </body>
</html>
